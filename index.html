<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Informações dos BOSS</title>
    <style>
        body {
            font-family: sans-serif;
            background-color: #121212;
            color: #e0e0e0;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            color: #4CAF50;
            text-align: center;
            margin-bottom: 5px;
        }

        #current-time {
            text-align: center;
            color: #90ee90;
            font-size: 0.9em;
            margin-bottom: 20px;
        }

        .controls-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            gap: 20px;
            margin-bottom: 20px;
        }

        .controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            width: 100%;
            max-width: 300px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            width: 100%;
            gap: 5px;
        }

        .controls label {
            font-weight: bold;
        }

        .controls select {
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #4CAF50;
            background-color: #1e1e1e;
            color: #e0e0e0;
            width: 100%;
            cursor: pointer;
        }

        .server-column {
            background-color: #1e1e1e;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 300px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .server-name {
            font-size: 1.5em;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 15px;
            text-align: center;
        }

        .subservers-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 100%;
        }

        .subservidor {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #2a2a2a;
            padding: 10px 15px;
            border-radius: 4px;
            border-left: 3px solid #4CAF50;
        }

        .subservidor-name {
            font-weight: bold;
        }

        .subservidor-time {
            font-size: 1.2em;
            font-weight: bold;
            color: #FFD700;
        }

        .sound-toggle {
            margin-top: 20px;
            padding: 10px 15px;
            border: 1px solid #4CAF50;
            background-color: #1e1e1e;
            color: #e0e0e0;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            text-align: center;
        }

        .sound-toggle:hover {
            background-color: #2a2a2a;
        }

        .boss-card {
            background-color: #1e1e1e;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .boss-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            width: 100%;
            justify-content: center;
        }

        .boss-header img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #4CAF50;
        }

        .boss-header .boss-spawn-img {
            width: 100px;
            height: auto;
            border-radius: 0;
            border: none;
            margin-top: 5px;
            transition: width 0.5s ease-in-out;
            cursor: pointer;
        }
        .boss-header .boss-spawn-img:hover {
            width: 400px;
        }
        
        .boss-header h2 {
            margin: 0;
            color: #e0e0e0;
        }

        .section-title {
            color: #4CAF50;
            font-size: 1.2em;
            margin-top: 15px;
            margin-bottom: 5px;
            text-align: left;
            width: 100%;
        }

        ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
            width: 100%;
            text-align: left;
        }

        li {
            background-color: #2a2a2a;
            border-left: 3px solid #4CAF50;
            padding: 10px;
            margin-bottom: 5px;
            border-radius: 4px;
        }

        .highlight {
            color: #FFD700;
            font-weight: bold;
        }

        .whatsapp-float {
            position: fixed;
            width: 60px;
            height: 60px;
            bottom: 20px;
            right: 20px;
            background-color: #25d366;
            color: #FFF;
            border-radius: 50px;
            text-align: center;
            box-shadow: 2px 2px 3px #999;
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.3s ease-in-out;
        }

        .whatsapp-float img {
            width: 35px;
            height: 35px;
        }

        .whatsapp-float:hover {
            transform: scale(1.1);
        }

        @media (min-width: 600px) {
            .controls-container {
                flex-direction: row;
            }

            .boss-card {
                flex-direction: row;
                align-items: flex-start;
                text-align: left;
            }

            .boss-header {
                justify-content: flex-start;
                flex-direction: column;
            }

            .boss-info {
                margin-left: 20px;
                flex-grow: 1;
            }

            .boss-header img {
                width: 100px;
                height: 100px;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Informações dos BOSS</h1>
    <p id="current-time"></p>

    <div class="controls-container">
        <div class="controls">
            <div class="control-group">
                <label for="filter-select">Filtro de Item:</label>
                <select id="filter-select">
                    <option value="all">Todos os Itens</option>
                    <option value="Receita de Relíquias">Receita de Relíquias</option>
                    <option value="Anel do Valento">Anel do Valento</option>
                    <option value="Colar do Kelvezu">Colar do Kelvezu</option>
                    <option value="Botas do Mokova">Botas do Mokova</option>
                    <option value="Anel Shy">Anel Shy</option>
                    <option value="Amuleto Tulla">Amuleto Tulla</option>
                    <option value="Botas do Draxos">Botas do Draxos</option>
                    <option value="Luvas do Greedy">Luvas do Greedy</option>
                    <option value="Amuleto do Yagditha">Amuleto do Yagditha</option>
                </select>
            </div>
            <div class="control-group">
                <label for="time-filter-select">Filtro por Horário:</label>
                <select id="time-filter-select">
                    <option value="all">Todos os Horários</option>
                    <script>
                        // Gera as opções de horário dinamicamente de 00 a 23
                        for (let i = 0; i < 24; i++) {
                            const hour = String(i).padStart(2, '0');
                            document.write(`<option value="${i}">${hour}hXX</option>`);
                        }
                    </script>
                </select>
            </div>
            <div class="control-group">
                <label for="sort-select">Ordenação:</label>
                <select id="sort-select">
                    <option value="next-spawn">Horário de Próxima Aparição</option>
                    <option value="Receita de Relíquias">Receita de Relíquias</option>
                    <option value="Anel do Valento">Anel do Valento</option>
                    <option value="Colar do Kelvezu">Colar do Kelvezu</option>
                    <option value="Botas do Mokova">Botas do Mokova</option>
                    <option value="Anel Shy">Anel Shy</option>
                    <option value="Amuleto Tulla">Amuleto Tulla</option>
                    <option value="Botas do Draxos">Botas do Draxos</option>
                    <option value="Luvas do Greedy">Luvas do Greedy</option>
                    <option value="Amuleto do Yagditha">Amuleto do Yagditha</option>
                </select>
            </div>
        </div>
        <div class="server-column">
            <div class="server-name">IDHAS</div>
            <div class="subservers-container" id="subservers-container">
            </div>
        </div>
    </div>
    
    <div id="bosses-container"></div>
    <a href="https://wa.me/55067996456868" class="whatsapp-float" target="_blank" aria-label="Fale no WhatsApp">
    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp" />
</a>
</div>

<script>
    const allBossesData = [
        {
            nome: "Babel", local: "Estrada de Ferro do Caos", horarios: [0, 3, 6, 9, 12, 15, 18, 21],
            drop: ["Itens do mapa, Essência do Babel e Receita de Relíquias (0,60% de chance)."],
            dano1: ["Não tem roleta"], dano2: ["Não tem roleta"], dano3: ["Não tem roleta"],
            img: "https://tioleobpt.com.br/imagens/Bosses/miniaturas/i_babel.webp",
            spaw : "https://ptlab.com.br/wp-content/uploads/2024/01/estrada-de-ferro-do-caos.png"
        },
        {
            nome: "Babel", local: "Coração de Perum", horarios: [1, 4, 7, 10, 13, 16, 19, 22],
            drop: ["Itens do mapa, Essência do Babel e Receita de Relíquias (0,60% de chance)."],
            dano1: ["Não tem roleta"], dano2: ["Não tem roleta"], dano3: ["Não tem roleta"],
            img: "https://tioleobpt.com.br/imagens/Bosses/miniaturas/i_babel.webp",
            spaw : "https://ptlab.com.br/wp-content/uploads/2024/01/coracao-de-perum.png"
        },
        {
            nome: "Fúria", local: "Templo Maldito - 3° Andar", horarios: [2, 5, 8, 11, 14, 17, 20, 23],
            drop: ["Itens do mapa, Essência do Fúria e Receita de Relíquias (1,20% de chance)."],
            dano1: ["Não tem roleta"], dano2: ["Não tem roleta"], dano3: ["Não tem roleta"],
            img: "https://tioleobpt.com.br/imagens/Bosses/miniaturas/i_furia.webp",
            spaw : "https://ptlab.com.br/wp-content/uploads/2024/01/templo-maldito-3.png"
        },
        {
            nome: "Valento", local: "Vale Gallubia", horarios: [1, 5, 9, 13, 17, 21],
            drop: ["Itens do mapa, Essência do Valento e Receita de Relíquias (1,60% de chance), e Anel do Valento (0,17% de Chance, e 0,19% no Omega)."],
            dano1: ["Não tem roleta"], dano2: ["Não tem roleta"], dano3: ["Não tem roleta"],
            img: "https://tioleobpt.com.br/imagens/Bosses/miniaturas/i_valento.webp",
            spaw : "https://ptlab.com.br/wp-content/uploads/2024/01/vale-gallubia.png"
        },
        {
            nome: "Kelvezu", local: "Covil do Kelvezu", horarios: [1, 7, 13, 19],
            drop: ["Itens do mapa, Essência do Kelvezu e Receita de Relíquias (1,20% de chance), e Colar do Kelvezu (0,17% de Chance, e 0,19% no Omega)."],
            dano1: ["Não tem roleta"], dano2: ["Não tem roleta"], dano3: ["Não tem roleta"],
            img: "https://tioleobpt.com.br/imagens/Bosses/miniaturas/i_kelvezu.webp",
            spaw : "https://ptlab.com.br/wp-content/uploads/2024/01/covil-do-kelvezu.png"
        },
        {
            nome: "Mokova", local: "Templo Perdido", horarios: [2, 8, 14, 20],
            drop: ["Itens do mapa, Essência do Mokova e Botas do Mokova (0,14% de Chance, e 0,16% no Omega)."],
            dano1: ["Não tem roleta"], dano2: ["Não tem roleta"], dano3: ["Não tem roleta"],
            img: "https://tioleobpt.com.br/imagens/Bosses/miniaturas/i_mokova.webp",
            spaw : "https://ptlab.com.br/wp-content/uploads/2024/01/templo-perdido.png"
        },
        {
            nome: "Shy", local: "Torre Sem Fim 3° Andar", horarios: [7, 15, 23],
            drop: ["Itens do mapa, Essência do Shy e Receita de Relíquias (1,60% de chance), e Anel Shy (0,14% de Chance, e 0,16% no Omega)."],
            dano1: ["Não tem roleta"], dano2: ["Não tem roleta"], dano3: ["Não tem roleta"],
            img: "https://tioleobpt.com.br/imagens/Bosses/miniaturas/i_shy.webp",
            spaw : "https://ptlab.com.br/wp-content/uploads/2024/01/torre-sem-fim-3-andar.png"
        },
        {
            nome: "Tulla", local: "Mina de Gelo", horarios: [4, 12, 20],
            drop: ["Itens do mapa, Essência do Tulla e Receita de Relíquias (1,60% de chance), e Amuleto Tulla (0,14% de Chance, e 0,16% no Omega)."],
            dano1: ["Não tem roleta"], dano2: ["Não tem roleta"], dano3: ["Não tem roleta"],
            img: "https://tioleobpt.com.br/imagens/Bosses/miniaturas/i_tulla.webp",
            spaw : "https://ptlab.com.br/wp-content/uploads/2024/01/mina-de-gelo.png"
        },
        {
            nome: "Draxos", local: "Laboratório Secreto", horarios: [9, 19],
            drop: ["Itens do mapa", "Essência do Draxos (2,40%)", "Receita de Relíquia (2,40%)", "Botas do Draxos (0,14% de Chance, e 0,16% no Omega)"],
            dano1: ["3x Sol (45%), 3x Meteoritos Idetas (12%), Runas Superiores (38%) ou Pergaminho de Invocação de Boss (Mokova, Shy ou Tulla) (5%)."],
            dano2: ["Pergaminho de Invocação do Draxos (10%), Runas Superiores (26%), Buff Especial (3H) (20%), Pergaminho de Invocação de Boss (Mokova, Shy ou Tulla) (15%), Itens de Ataque level 118 (17%), 33.766.200.000 pontos de Experiência (5%) ou Essências do Aging (I), (A) ou (S) (10%)."],
            dano3: ["Pergaminho de Invocação do Draxos (10%), Caixa Priston (3H) (8%), Pergaminho de Invocação de Boss (Mokova, Shy ou Tulla) (15%), Itens de Defesa level 118 (21%), Itens de Ataque level 118 (21%), Essência do Draxos (5%), 41.496.000.000 pontos de Experiência (5%) ou Essências do Aging (I), (A) ou (S) (10%)."],
            img: "https://tioleobpt.com.br/imagens/Bosses/miniaturas/i_draxos.webp",
            spaw : "https://ptlab.com.br/wp-content/uploads/2024/01/laboratorio-secreto.png"
        },
        {
            nome: "Greedy", local: "Arma Antiga", horarios: [10, 21],
            drop: ["Itens do mapa, Essência do Greedy e Receita de Relíquias (2,40% de chance), e Luvas do Greedy (0,14% de Chance, e 0,16% no Omega)."],
            dano1: ["3x Sol (45%), 3x Meteoritos Idetas (12%), Runas Superiores (38%) ou Pergaminho de Invocação de Boss (Mokova, Shy ou Tulla) (5%)."],
            dano2: ["Pergaminho de Invocação do Greedy (10%), Runas Superiores (26%), Buff Especial (3H) (20%), Pergaminho de Invocação de Boss (Tulla, Shy ou Draxos) (15%), Itens de Ataque level 123 (17%), 41.496.000.000 pontos de Experiência (5%) ou Essências do Aging (I), (A) ou (S) (2%)."],
            dano3: ["Pergaminho de Invocação do Greedy (10%), Pergaminho de Invocação de Boss (Shy, Tulla ou Draxos) (15%), Essências do Aging (I), (A) ou (S) (10%), Itens de Defesa level 123 (21%), Itens de Ataque level 123 (21%), Caixa Priston (3H) (8%), Essência do Greedy (5%), ou 69.949.440.000 pontos de Experiência (5%)."],
            img: "https://tioleobpt.com.br/imagens/Bosses/miniaturas/i_greedy.webp",
            spaw : "https://ptlab.com.br/wp-content/uploads/2024/01/arma-antiga.png"
        },
        {
            nome: "Espectro do Midranda", local: "Estrada Sombria", horarios: [11, 19],
            drop: ["Itens do mapa", "Receita de Relíquia"],
            dano1: ["3x Sol (45%), 3x Meteoritos Idetas (12%), Runas Superiores (38%) ou Pergaminho de Invocação de Boss (Greedy, Tulla ou Draxos) (5%)."],
            dano2: ["Pergaminho de Invocação Espectro do Midranda (10%), Runas Superiores (26%), Buff Especial (3H) (20%), Pergaminho de Invocação de Boss (Draxos, Tulla ou Greddy) (15%), Itens de Ataque level 130 (17%), 69.959.440.000 pontos de Experiência (5%) ou Essências do Aging (I), (A) ou (S) (2%)."],
            dano3: ["Pergaminho de Invocação Espectro do Midranda (10%), Pergaminho de Invocação de Boss (Greedy, Tulla ou Draxos) (15%), Essências do Aging (I), (A) ou (S) (10%), Itens de Defesa level 130 (21%), Itens de Ataque level 130 (21%), Caixa Priston (3H) (8%), Essências do Babel, Fúria, Valento, Kelvezu, Mokova, Shy, Tulla, Draxos ou Greedy (5%), ou 84.779.847.000 pontos de Experiência (5%)."],
            img: "https://tioleobpt.com.br/imagens/Bosses/miniaturas/i_espectro.webp",
            spaw : "https://ptlab.com.br/wp-content/uploads/2024/01/estrada-sombria.png"
        },
        {
            nome: "Yagditha", local: "Abismo do Mar", horarios: [20],
            drop: ["Itens do mapa, Essência do Yagditha e Receita de Relíquias (3,69% de chance), Amuleto do Yagditha (Alfa, Beta, Gama e Zeta) (0,16% de chance) Amuleto do Yagditha (Omega) (0,25% de chance)."],
            dano1: ["3x Sol (45%), 3x Meteoritos Idetas (12%), Runas Superiores (38%) ou Pergaminho de Invocação de Boss (Greedy, Draxos ou Espectro do Midranda) (5%)."],
            dano2: ["Pergaminho de Invocação Espectro do Midranda (20%), Runas Superiores (26%), Buff Especial (3H) (15%), Pergaminho de Invocação de Boss (Draxos ou Greddy) (15%), Itens de Ataque level 140 (17%), 84.779.847.000 pontos de Experiência (5%) ou Essências do Aging (I), (A) ou (S) (2%)."],
            dano3: ["Pergaminho de Invocação Espectro do Midranda (10%), Pergaminho de Invocação de Boss (Greedy ou Draxos) (15%), Essências do Aging (I), (A) ou (S) (15%), Itens de Defesa level 140 (21%), Itens de Ataque level 140 (21%), Caixa Priston (3H) (8%), Essências do Yagditha (5%), ou 135.933.805.500 pontos de Experiência (5%)."],
            img: "https://tioleobpt.com.br/imagens/Bosses/miniaturas/i_yagditha.webp",
            spaw : "https://ptlab.com.br/wp-content/uploads/2024/01/abismo-do-mar.png"
        },
        {
            nome: "Dragão Snowstorn", local: "Abismo do Mar Congelado", horarios: [11, 22],
            drop: ["Itens do mapa"],
            dano1: ["3x Sol (45%), 3x Meteoritos Idetas (12%), Runas Superiores (38%) ou Pergaminho de Invocação de Boss (Greedy, Draxos ou Espectro do Midranda) (5%)."],
            dano2: ["Pergaminho de Invocação Espectro do Midranda (20%), Runas Superiores (26%), Buff Especial (3H) (15%), Pergaminho de Invocação de Boss (Draxos ou Greddy) (15%), Itens de Ataque level 140 (17%), 135.933.805.500 pontos de Experiência (5%) ou Essências do Aging (I), (A) ou (S) (2%)."],
            dano3: ["Pergaminho de Invocação Espectro do Midranda (10%), Pergaminho de Invocação de Boss (Greedy ou Draxos) (15%), Essências do Aging (I), (A) ou (S) (15%), Itens de Defesa level 140 (21%), Itens de Ataque level 140 (21%), Caixa Priston (3H) (8%), Essências do Babel, Valento, Kelvezu, Fúria, Mokova, Tulla, Draxos, Greedy e Yagditha (5%), ou 150.878.802.000 pontos de Experiência (5%)."],
            img: "https://tioleobpt.com.br/imagens/Bosses/miniaturas/i_snow.webp",
            spaw : "https://ptlab.com.br/wp-content/uploads/2024/01/abismo-do-mar-congelado.png"
        },
        {
            nome: "Midranda Ressurgido", local: "Santuário do Abismo", horarios: [19],
            drop: ["Itens do mapa, Essência do Midranda e Receita de Relíquias (4,80% de chance), e Brinco do Midranda (Alfa, Beta, Gama e Zeta. 0,16% de chance) e (Omega 0,18% de chance)."],
            dano1: ["3x Sol (45%), 3x Meteoritos Idetas (12%), Runas Superiores (38%) ou Pergaminho de Invocação de Boss (Greedy, Espectro do Midranda ou Yagditha) (5%)."],
            dano2: ["Pergaminho de Invocação Espectro do Midranda (20%), Runas Superiores (26%), Buff Especial (3H) (15%), Pergaminho de Invocação de Boss (Yagditha ou Greddy) (15%), Itens de Ataque level 140 (17%), 150.878.802.000 pontos de Experiência (5%) ou Essências do Aging (I), (A) ou (S) (2%)."],
            dano3: ["Pergaminho de Invocação Espectro do Midranda (10%), Pergaminho de Invocação de Boss (Greedy ou Yagditha) (15%), Essências do Aging (I), (A) ou (S) (15%), Itens de Defesa level 140 (21%), Itens de Ataque level 140 (21%), Caixa Priston (3H) (8%), Essência do Midranda (5%), ou 199.600.125.000 pontos de Experiência (5%)."],
            img: "https://tioleobpt.com.br/imagens/Bosses/miniaturas/i_midrandaress.webp",
            spaw : "https://ptlab.com.br/wp-content/uploads/2024/01/santuario-do-abismo.png"
        }
    ];

    const bossesContainer = document.getElementById('bosses-container');
    const timeDisplay = document.getElementById('current-time');
    const filterSelect = document.getElementById('filter-select');
    const timeFilterSelect = document.getElementById('time-filter-select');
    const sortSelect = document.getElementById('sort-select');
    const sheetUrl = 'https://script.google.com/macros/s/AKfycbxBOyU1-CxIpSqHJW94imrkMctg8WrbO7w8ZnWBmlyVRz53KaNklmyPbBVIdyluI246/exec';
    const subserversContainer = document.getElementById('subservers-container');

    async function fetchServerTimes() {
        try {
            const response = await fetch(sheetUrl);
            const data = await response.json(); // Já é um array de objetos

            // Remove conteúdo anterior para evitar duplicatas
            subserversContainer.innerHTML = '';

            data.forEach(item => {
                const name = item.Idhas;
                const time = item.Horario;
                if (name && time !== undefined) {
                    const subserverDiv = document.createElement('div');
                    subserverDiv.className = 'subservidor';
                    subserverDiv.innerHTML = `
                        <span class="subservidor-name">${name}:</span>
                        <span class="subservidor-time">${String(time).padStart(2, '0')}</span>
                    `;
                    subserversContainer.appendChild(subserverDiv);
                }
            });
        } catch (error) {
            console.error('Erro ao carregar os dados da planilha:', error);
            subserversContainer.innerHTML = '<p style="color: red;">Erro ao carregar os horários. Tente novamente mais tarde.</p>';
        }
    }

    function updateTimeDisplay() {
        const now = new Date();
        const year = now.getFullYear();
        const month = (now.getMonth() + 1).toString().padStart(2, '0');
        const day = now.getDate().toString().padStart(2, '0');
        const hour = now.getHours().toString().padStart(2, '0');
        const minute = now.getMinutes().toString().padStart(2, '0');
        const formattedTime = `${year}-${month}-${day}  ${hour}:${minute}`;

        timeDisplay.textContent = `Data e Hora de referência: ${formattedTime}`;
    }

    function getDropChance(boss, dropItemName) {
        if (!boss.drop) return 0;
        const dropString = boss.drop.join(' ');
        const regex = new RegExp(`${dropItemName}\\s*\\(([^)]+)%`, 'i');
        const match = dropString.match(regex);
        if (match && match[1]) {
            const chance = parseFloat(match[1].replace(',', '.'));
            return isNaN(chance) ? 0 : chance;
        }
        return 0;
    }

    function getNextAppearance(horarios) {
        const now = new Date();
        const currentHour = now.getHours();
        const sortedHorarios = horarios.slice().sort((a, b) => a - b);
        
        for (const horario of sortedHorarios) {
            if (horario >= currentHour) {
                return horario;
            }
        }
        return sortedHorarios[0] + 24;
    }
    
    function renderBosses() {
        const selectedFilter = filterSelect.value;
        const selectedTimeFilter = timeFilterSelect.value;
        const selectedSort = sortSelect.value;

        // Passo 1: Filtrar os bosses por item
        let filteredBosses = allBossesData.filter(boss => {
            if (selectedFilter === 'all') {
                return true;
            }
            const dropString = boss.drop ? boss.drop.join(' ') : '';
            return dropString.includes(selectedFilter);
        });

        // Passo 2: Filtrar os bosses por horário
        if (selectedTimeFilter !== 'all') {
            const hourToFilter = parseInt(selectedTimeFilter);
            filteredBosses = filteredBosses.filter(boss => {
                return boss.horarios.includes(hourToFilter);
            });
        }

        // Passo 3: Ordenar os bosses
        let sortedBosses = [...filteredBosses];

        if (selectedSort === 'next-spawn') {
            sortedBosses.forEach(boss => {
                boss.nextAppearance = getNextAppearance(boss.horarios);
            });
            sortedBosses.sort((a, b) => a.nextAppearance - b.nextAppearance);
        } else {
            sortedBosses.sort((a, b) => {
                const chanceA = getDropChance(a, selectedSort);
                const chanceB = getDropChance(b, selectedSort);
                return chanceB - chanceA; // Ordem decrescente de chance
            });
        }

        // Passo 4: Renderizar a lista
        bossesContainer.innerHTML = '';
        const currentHour = new Date().getHours();
        
        sortedBosses.forEach(info => {
            const bossCard = document.createElement('div');
            bossCard.className = 'boss-card';

            const bossHeader = document.createElement('div');
            bossHeader.className = 'boss-header';

            const bossImage = document.createElement('img');
            bossImage.src = info.img;
            bossImage.alt = `Imagem de ${info.nome}`;
            bossImage.loading = 'lazy';
            
            const spawnImage = document.createElement('img');
            spawnImage.src = info.spaw;
            spawnImage.alt = `Mapa de ${info.nome}`;
            spawnImage.loading = 'lazy';
            spawnImage.className = 'boss-spawn-img';
            
            const bossTitle = document.createElement('h2');
            bossTitle.textContent = info.nome;
            
            bossHeader.appendChild(bossImage);            
            bossHeader.appendChild(bossTitle);
            bossHeader.appendChild(spawnImage);

            const bossInfo = document.createElement('div');
            bossInfo.className = 'boss-info';
            
            const horariosString = info.horarios.map(h => {
                const formattedHour = String(h).padStart(2, '0') + 'hXX';
                if (h === currentHour) {
                    return `<span class="highlight">${formattedHour}</span>`;
                }
                return formattedHour;
            }).join(', ');

            bossInfo.innerHTML = `
                <p><strong>Local:</strong> ${info.local}</p>
                <p><strong>Horários:</strong> ${horariosString}</p>
            `;

            const createList = (title, items) => {
                if (items && items.length > 0) {
                    const listTitle = document.createElement('h3');
                    listTitle.className = 'section-title';
                    listTitle.textContent = title;
                    bossInfo.appendChild(listTitle);

                    const ul = document.createElement('ul');
                    items.forEach(item => {
                        const li = document.createElement('li');
                        li.textContent = item;
                        ul.appendChild(li);
                    });
                    bossInfo.appendChild(ul);
                }
            };
            
            createList('Drops', info.drop);
            createList('Dano 1 (50.000 a 349.999)', info.dano1);
            createList('Dano 2 (350.000 a 999.999)', info.dano2);
            createList('Dano 3 (1.000.000 e superior)', info.dano3);

            bossCard.appendChild(bossHeader);
            bossCard.appendChild(bossInfo);
            bossesContainer.appendChild(bossCard);
        });
    }

    // Adiciona event listeners para os filtros
    filterSelect.addEventListener('change', renderBosses);
    timeFilterSelect.addEventListener('change', renderBosses);
    sortSelect.addEventListener('change', renderBosses);

    // Renderiza a lista de bosses e o horário quando a página carrega
    fetchServerTimes();
    renderBosses();
    updateTimeDisplay();
    
    // Atualiza a cada minuto para reordenar a lista e destacar o horário
    setInterval(renderBosses, 60000);
    // Atualiza a cada segundo para manter o horário exato
    setInterval(updateTimeDisplay, 1000);
</script>

</body>
</html> 